# セットアップ方法

## 必要なもの（作成時の動作環境）

- NIVISA (NIVISA1400)
- NI488.2 (NI4882_1760f0)
- python (python3.9.7)

## NIVISAの設定（うろ覚えなので違うかも）

1. NIVISAのsetup.exeを起動しデフォルトの設定のままインストール
2. NI4882のsetup.exeを起動しこれもデフォルト設定でインストール

### NIVISAが正常に動作しているかの確認方法

1. スタートメニューの検索バーにNIMAXと打てば多分でてくるので起動する（なければNIVISAのインストールし直し）
2. NIMAXの｢デバイスとインターフェイス｣の左のプルダウン（vみたいなやつ）をクリック
3. GPIBがつながっていればさらにプルダウンがあるアイテムがでてくるのでプルダウンをクリック
4. 自分の通信したい機器を選択して｢計測器と通信する｣をクリック
5. 送信文字列に`"*IDN?"`を入力して｢クエリ｣をクリック
6. 装置の名前がかえってこれば問題なし

## pythonの設定（Wi-Fi環境必須）

1. python**.exeをダブルクリックで起動
2. Add Python 3.9 To Pathみたいなチェックマークにチェック（チェックをつけずにインストールしてしまったときはもう一度インストーラーを起動すればよい）
3. その他はとくに設定を変えずに進めてインストールを完了させる
4. このファイルがあるフォルダーで何も選択していない状態で背景の白いところをShiftキー押しながら右クリック
5. ｢PowerShellウィンドウをここで開く｣ を選択
6. PowerShellで`python -m pip install -r requirements.txt`を入力しエンター
7. インストールが終わってSuccessfullyなんちゃらってメッセージがでたら完了

"WARNING: You are using pip version~"みたいな警告は無視して良い

### pythonの設定がうまくいっているかの確認

1. 実行ファイル（exeファイル、おそらくGPyM.exeというファイル）を実行
2. 定義ファイルは`GPyM\Example\define.def`、測定マクロは`test.py`を選択
3. ちゃんと動いて`GPyM\Example\data`にデータが入っていればOK

このマクロはGPIB通信を行わないのでNIVISAの確認はできない。GPIB通信の確認をするにはマクロで`operation_check`を選択。


#うまくいかないときは
Q. "'CDにはscriptsという名前のフォルダーが存在しません' は、内部コマンドまたは外部コマンド、
操作可能なプログラムまたはバッチ ファイルとして認識されていません。"とでてくる
A. batファイルの改行記号が違う可能性があります LFかCRLFかどちらかに変えてみましょう
