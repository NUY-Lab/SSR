# セットアップ方法

## 必要なもの

- NIVISA (NIVISA1400) (runtimeで良い?)
- NI-488.2 (NI4882_1760f0) (runtimeで良い)
- Python >= 3.9

## NIVISAの設定

1. NI-488.2のautorun.exeを起動しこれもデフォルト設定でインストール
2. NIVISAのsetup.exeを起動しデフォルトの設定のままインストール

### NIVISAが正常に動作しているかの確認方法

1. スタートメニューの検索バーにNIMAXと打てば多分でてくるので起動する（runtimeのNIVISAをいれると出てこないかも）
2. NIMAXの｢デバイスとインターフェイス｣の左のプルダウン（vみたいなやつ）をクリック
3. GPIBがつながっていればさらにプルダウンがあるアイテムがでてくるのでプルダウンをクリック
4. 自分の通信したい機器を選択して｢計測器と通信する｣をクリック
5. 送信文字列に`"*IDN?"`を入力して｢クエリ｣をクリック
6. 装置の名前がかえってこれば問題なし

## Pythonの設定

1. Microsoft Storeまたは[公式サイト](https://www.python.org/)などからPythonをインストール
2. `python -m pip install pipenv`または`py -m pip install pipenv`を実行してPipenvをインストール
   - Pythonが見つからない等のPath関連のエラーは再起動すると解決する可能性
3. プロジェクトルートに移動して(わからなければSSR.exeのあるフォルダでSHIFTキーを押しながら右クリックして"PowerShellウィンドウでここを開く"を選択)
   `py -m pipenv sync`を実行
   - 開発用のパッケージをインストールする場合には`--dev`フラグをつける
   - Pythonのバージョンが古い場合にはパッケージのインストール中にエラーが起きるのでその場合はPythonのバージョンを上げてください

Pipenvでは自動で仮想環境が作られ、そこにライブラリがインストールされる。仮想環境に入るには`pipenv shell`を実行すればよく、抜ける場合には`exit`を実行すればよい。
